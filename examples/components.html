<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Crud on Vue</title>
    <!-- bootstrap4 css -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- minimal crud-vue css -->
    <link href="../dist/crud-vue.css" rel="stylesheet">
    <!-- font-awesome -->
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script
        src="https://code.jquery.com/jquery-2.2.4.min.js"
        integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <!-- Vue js -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- crud-vue.js -->
    <script src="../dist/crud-vue.js"></script>
    <script src="./extras/edit_area/edit_area_full.js"></script>
    <script src="./extras/ModelUser.js"></script>
</head>
<body>
<div>
    <div class="navbar">
        <h1><a href="./index.html">CRUD</a> <small>framework basato su vue</small></h1>
    </div>

    <div id="app">
        <!-- crud vue container -->
        <c-router ref="router" c-default-command="c-test?cComponent=w-input" c-content-id="#app-content"></c-router>
        <div class="row">
            <div class="col-3">
                <div class="accordion" id="myAccordion">
                    <div class="card">
                        <div class="card-header" id="headingOne">
                            <h2 class="mb-0">
                                <button type="button" class="btn btn-link" data-toggle="collapse" data-target="#collapseOne">Widgets</button>
                            </h2>
                        </div>
                        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#myAccordion">
                            <div class="card-body">
                                <div>Widgets</div>
                                <ul class="">
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-input&cConf=wInputConf">rInput</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-input&cConf=wPasswordConf">rInput password</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-input-helped&cConf=wInputHelpedConf">rInputHelped</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-autocomplete&cConf=wAutocompleteConf">rAutocomplete</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-belongsto&cConf=wBelongstoConf">rBelongsto</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-radio">rRadio</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-checkbox">rCheckbox</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-select">rSelect</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-textarea">rTextarea</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-text">rText</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-date-select">rDateSelect</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-date-picker">rDatePicker</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-texthtml">rTexthtml</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-hasmany">rHasmany</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-hasmany-view">rHasmanyView</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-swap">rSwap</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-b2-select2">rB2Select2</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-b2m-select2">rB2MSelect2</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-upload">rUpload</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=w-upload-ajax">rUploadAjax</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header" id="headingTwo">
                            <h2 class="mb-0">
                                <button type="button" class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo">Views</button>
                            </h2>
                        </div>
                        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#myAccordion">
                            <div class="card-body">
                                <div>Views</div>
                                <ul class="">
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-edit&cConf=vCustomConf">Custom Record</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-search&cModel=user">Search user</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-insert&cModel=user">Insert user</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-edit&cModel=user&cPk=4">Edit user 4</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-view&cModel=user&cPk=4">View user 4</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-list&cConf=vCustomListConf">Custom List</a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-list&cModel=user">List user </a></li>
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=v-list-edit&cModel=user">List Edit user </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header" id="headingThree">
                            <h2 class="mb-0">
                                <button type="button" class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree">Dialogs</button>
                            </h2>
                        </div>
                        <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#myAccordion">
                            <div class="card-body">
                                <div>Dialogs</div>
                                <ul class="">
                                    <li class="nav-item pl-2"><a href="#c-test?cFunc=message-dialog">Manage user</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header" id="headingThree">
                            <h2 class="mb-0">
                                <button type="button" class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree">Dashboards</button>
                            </h2>
                        </div>
                        <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#myAccordion">
                            <div class="card-body">
                                <div>Dashboards</div>
                                <ul class="">
                                    <li class="nav-item pl-2"><a href="#c-test?cComponent=c-manage&cModel=user">Manage user</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-9">
                <div id="app-content"></div>
                <div class="m-3">
                    <div class="clearfix">
                        <div class="pull-left">Configurazione componente</div>
                        <button class="pull-right btn btn-primary btn-sm" onclick="ricarica()">Ricarica</button>
                    </div>
                    <div >
                        <div >
                            <textarea id="editor" style="height:400px;width:100%"></textarea>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>
<script>
    var app = null;
    function ricarica() {
        app.$set(app.$refs['router'].lastComponent,'conf',null);
        app.waitStart();
        setTimeout( function () {
            app.waitEnd();
            var code = editAreaLoader.getValue('editor');
            console.log('code',code);
            eval('var obj = ' + code);
            console.log('obj',obj);
            app.$set(app.$refs['router'].lastComponent,'conf',obj);
        },10);

    };
    jQuery( function() {
        jQuery('body').on('set-code',function (event,confName) {
            console.log('event confName',confName);
            var code = window[confName+"_f"]?window[confName+"_f"].toString().match(/function[^{]+\{([\s\S]*)\}$/)[1]:"{}";
            editAreaLoader.setValue('editor',code)
        });
        app = new CrudApp({
            mounted : function() {
                editAreaLoader.init({
                    id: "editor"	// id of the textarea to transform
                    ,start_highlight: true	// if start with highlight
                    ,allow_resize: "both"
                    ,allow_toggle: true
                    ,word_wrap: true
                    ,language: "en"
                    ,syntax: "js"
                });

            },
            data : function () {

                return {
                    // default template  html della libreria basato su bootstrap4
                    templatesFile : '../dist/crud-vue.html',
                    // -- path plugins se usi qualche particolare plugin
                    //pluginsPath : '/bootstrap4/plugins/',
                    // -- configurazioni personali per ridefinire o aggiungere comportamenti della libreria
                    appConfig : './extras/myconf.js',
                    el : '#app'
                };
            }
        });
    });
</script>
<!-- file configurazione componenti d'esempio -->
<script src="./extras/components-conf.js"></script>
</body>
</html>
